"Name";"Severity";"Description";"Query";"QueryType";"ThresholdOperator";"Threshold";"FrequencyInMinutes";"TimeWindowInMinutes";"MTThresholdOperator";"MTThreshold";"MTMetricTriggerType";"MTMetricColumn";"AG"
"Application Gateway - Client Round Trip Latency - Warning";"1";"Application Gateway - Client Round Trip Latency - Warning";"let _resources = TagData_CL| where Tags_s contains '""te-managed-service"": ""workload""'| summarize arg_max(TimeGenerated, *) by Id_s = tolower(Id_s);let _perf = AzureMetrics | where MetricName == 'ClientRtt'; _perf | join kind=inner _resources on $left._ResourceId == $right.Id_s | summarize AggregatedValue = avg(Average) by bin(TimeGenerated, 5m), Resource";"ResultCount";"GreaterThan";"1000";"30";"60";"GreaterThan";"0";"Consecutive";"Resource";"/subscriptions/3a60e7b7-ac49-45d8-8a8f-ba61cdc5dc1f/resourceGroups/rg-teshared-custz-test/providers/microsoft.insights/actionGroups/tm-warning-actiongroup"
"Application Gateway - Unhealthy Backend Count - Warning";"1";"Application Gateway - Unhealthy Backend Count - Warning";"let _resources = TagData_CL| where Tags_s contains '""te-managed-service"": ""workload""'| summarize arg_max(TimeGenerated, *) by Id_s = tolower(Id_s);let _perf = AzureMetrics | where MetricName == 'UnhealthyHostCount'; _perf | join kind=inner _resources on $left._ResourceId == $right.Id_s | summarize AggregatedValue = avg(Count) by bin(TimeGenerated, 5m), Resource";"ResultCount";"GreaterThan";"0";"30";"60";"GreaterThan";"0";"Consecutive";"Resource";"/subscriptions/3a60e7b7-ac49-45d8-8a8f-ba61cdc5dc1f/resourceGroups/rg-teshared-custz-test/providers/microsoft.insights/actionGroups/tm-warning-actiongroup"
"Azure Function - Errors - Critical";"0";"Azure Function - Errors - Critical";"let _resources = TagData_CL| where Tags_s contains '""te-managed-service"": ""workload""'| summarize arg_max(TimeGenerated, *) by Id_s = tolower(Id_s);let _perf = AppExceptions ; _perf | join kind=inner _resources on $left._ResourceId == $right.Id_s | summarize AggregatedValue = count() by bin(TimeGenerated, 5m), AppRoleName";"ResultCount";"GreaterThan";"80";"5";"5";"GreaterThan";"0";"Consecutive";"AppRoleName";"/subscriptions/3a60e7b7-ac49-45d8-8a8f-ba61cdc5dc1f/resourceGroups/rg-teshared-custz-test/providers/microsoft.insights/actionGroups/tm-critical-actiongroup"
"Azure Function - Errors - Warning";"1";"Azure Function - Errors - Warning";"let _resources = TagData_CL| where Tags_s contains '""te-managed-service"": ""workload""'| summarize arg_max(TimeGenerated, *) by Id_s = tolower(Id_s);let _perf = AppExceptions ; _perf | join kind=inner _resources on $left._ResourceId == $right.Id_s | summarize AggregatedValue = count() by bin(TimeGenerated, 5m), AppRoleName";"ResultCount";"GreaterThan";"30";"5";"5";"GreaterThan";"0";"Consecutive";"AppRoleName";"/subscriptions/3a60e7b7-ac49-45d8-8a8f-ba61cdc5dc1f/resourceGroups/rg-teshared-custz-test/providers/microsoft.insights/actionGroups/tm-warning-actiongroup"
"Azure SQL - CPU Usage - Critical";"0";"Azure SQL - CPU Usage - Critical";"let _resources = TagData_CL| where Tags_s contains '""te-managed-service"": ""workload""'| summarize arg_max(TimeGenerated, *) by Id_s = tolower(Id_s);let _perf = AzureMetrics | where MetricName == 'cpu_percent' and ResourceProvider == 'MICROSOFT.SQL'  ; _perf| join kind=inner _resources on $left._ResourceId == $right.Id_s | summarize AggregatedValue = avg(Average) by bin(TimeGenerated, 5m), Resource";"ResultCount";"GreaterThan";"90";"5";"15";"GreaterThan";"2";"Consecutive";"Resource";"/subscriptions/3a60e7b7-ac49-45d8-8a8f-ba61cdc5dc1f/resourceGroups/rg-teshared-custz-test/providers/microsoft.insights/actionGroups/tm-critical-actiongroup"
"Azure SQL - CPU Usage - Warning";"1";"Azure SQL - CPU Usage - Warning";"let _resources = TagData_CL| where Tags_s contains '""te-managed-service"": ""workload""'| summarize arg_max(TimeGenerated, *) by Id_s = tolower(Id_s);let _perf = AzureMetrics | where MetricName == 'cpu_percent' and ResourceProvider == 'MICROSOFT.SQL'  ; _perf| join kind=inner _resources on $left._ResourceId == $right.Id_s | summarize AggregatedValue = avg(Average) by bin(TimeGenerated, 5m), Resource";"ResultCount";"GreaterThan";"80";"5";"15";"GreaterThan";"2";"Consecutive";"Resource";"/subscriptions/3a60e7b7-ac49-45d8-8a8f-ba61cdc5dc1f/resourceGroups/rg-teshared-custz-test/providers/microsoft.insights/actionGroups/tm-warning-actiongroup"
"Azure SQL - Data IO Percentage - Critical";"0";"Azure SQL - Data IO Percentage - Critical";"let _resources = TagData_CL| where Tags_s contains '""te-managed-service"": ""workload""'| summarize arg_max(TimeGenerated, *) by Id_s = tolower(Id_s);let _perf = AzureMetrics | where MetricName == 'physical_data_read_percent' and ResourceProvider == 'MICROSOFT.SQL'  ; _perf| join kind=inner _resources on $left._ResourceId == $right.Id_s | summarize AggregatedValue = avg(Average) by bin(TimeGenerated, 5m), Resource";"ResultCount";"GreaterThan";"90";"5";"15";"GreaterThan";"2";"Consecutive";"Resource";"/subscriptions/3a60e7b7-ac49-45d8-8a8f-ba61cdc5dc1f/resourceGroups/rg-teshared-custz-test/providers/microsoft.insights/actionGroups/tm-critical-actiongroup"
"Azure SQL - Data IO Percentage - Warning";"1";"Azure SQL - Data IO Percentage - Warning";"let _resources = TagData_CL| where Tags_s contains '""te-managed-service"": ""workload""'| summarize arg_max(TimeGenerated, *) by Id_s = tolower(Id_s);let _perf = AzureMetrics | where MetricName == 'physical_data_read_percent' and ResourceProvider == 'MICROSOFT.SQL'  ; _perf| join kind=inner _resources on $left._ResourceId == $right.Id_s | summarize AggregatedValue = avg(Average) by bin(TimeGenerated, 5m), Resource";"ResultCount";"GreaterThan";"80";"5";"15";"GreaterThan";"2";"Consecutive";"Resource";"/subscriptions/3a60e7b7-ac49-45d8-8a8f-ba61cdc5dc1f/resourceGroups/rg-teshared-custz-test/providers/microsoft.insights/actionGroups/tm-warning-actiongroup"
"Azure SQL - Data Space Used - Critical";"0";"Azure SQL - Data Space Used - Critical";"let _resources = TagData_CL| where Tags_s contains '""te-managed-service"": ""workload""'| summarize arg_max(TimeGenerated, *) by Id_s = tolower(Id_s);let _perf = AzureMetrics | where MetricName == 'storage_percent' and ResourceProvider == 'MICROSOFT.SQL'  ; _perf| join kind=inner _resources on $left._ResourceId == $right.Id_s | summarize AggregatedValue = avg(Average) by bin(TimeGenerated, 30m), Resource";"ResultCount";"GreaterThan";"90";"30";"30";"GreaterThan";"2";"Total";"Resource";"/subscriptions/3a60e7b7-ac49-45d8-8a8f-ba61cdc5dc1f/resourceGroups/rg-teshared-custz-test/providers/microsoft.insights/actionGroups/tm-critical-actiongroup"
"Azure SQL - Data Space Used - Warning";"1";"Azure SQL - Data Space Used - Warning";"let _resources = TagData_CL| where Tags_s contains '""te-managed-service"": ""workload""'| summarize arg_max(TimeGenerated, *) by Id_s = tolower(Id_s);let _perf = AzureMetrics | where MetricName == 'storage_percent' and ResourceProvider == 'MICROSOFT.SQL'  ; _perf| join kind=inner _resources on $left._ResourceId == $right.Id_s | summarize AggregatedValue = avg(Average) by bin(TimeGenerated, 30m), Resource";"ResultCount";"GreaterThan";"80";"30";"30";"GreaterThan";"0";"Total";"Resource";"/subscriptions/3a60e7b7-ac49-45d8-8a8f-ba61cdc5dc1f/resourceGroups/rg-teshared-custz-test/providers/microsoft.insights/actionGroups/tm-warning-actiongroup"
"Azure SQL - DTU Usage - Critical";"0";"Azure SQL - DTU Usage - Critical";"let _resources = TagData_CL| where Tags_s contains '""te-managed-service"": ""workload""'| summarize arg_max(TimeGenerated, *) by Id_s = tolower(Id_s);let _perf = AzureMetrics | where MetricName == 'dtu_consumption_percent'  ; _perf| join kind=inner _resources on $left._ResourceId == $right.Id_s | summarize AggregatedValue = avg(Average) by bin(TimeGenerated, 5m), Resource";"ResultCount";"GreaterThan";"90";"5";"15";"GreaterThan";"2";"Consecutive";"Resource";"/subscriptions/3a60e7b7-ac49-45d8-8a8f-ba61cdc5dc1f/resourceGroups/rg-teshared-custz-test/providers/microsoft.insights/actionGroups/tm-critical-actiongroup"
"Azure SQL - DTU Usage - Warning";"1";"Azure SQL - DTU Usage - Warning";"let _resources = TagData_CL| where Tags_s contains '""te-managed-service"": ""workload""'| summarize arg_max(TimeGenerated, *) by Id_s = tolower(Id_s);let _perf = AzureMetrics | where MetricName == 'dtu_consumption_percent'  ; _perf| join kind=inner _resources on $left._ResourceId == $right.Id_s | summarize AggregatedValue = avg(Average) by bin(TimeGenerated, 5m), Resource";"ResultCount";"GreaterThan";"80";"5";"15";"GreaterThan";"2";"Consecutive";"Resource";"/subscriptions/3a60e7b7-ac49-45d8-8a8f-ba61cdc5dc1f/resourceGroups/rg-teshared-custz-test/providers/microsoft.insights/actionGroups/tm-warning-actiongroup"
"Azure VM - Agent Unreachable - Critical";"0";"Azure VM - Agent Unreachable - Critical";"let _resources = TagData_CL| where Tags_s contains '""te-managed-service"": ""workload""'| summarize arg_max(TimeGenerated, *) by Id_s = tolower(Id_s);let _perf = Heartbeat  ; _perf| join kind=inner _resources on $left._ResourceId == $right.Id_s | extend d=parse_json(Tags_s) | extend CMDB_Id=d['te-cmdb-ci-id'] | summarize LastCall = max(TimeGenerated) by Computer, tostring(CMDB_Id), SubscriptionId = _SubscriptionId | where LastCall < ago(20m)";"ResultCount";"GreaterThan";"0";"5";"60";;;;;"/subscriptions/3a60e7b7-ac49-45d8-8a8f-ba61cdc5dc1f/resourceGroups/rg-teshared-custz-test/providers/microsoft.insights/actionGroups/tm-critical-actiongroup"
"Azure VM - Agent Unreachable - Warning";"1";"Azure VM - Agent Unreachable - Warning";"let _resources = TagData_CL| where Tags_s contains '""te-managed-service"": ""workload""'| summarize arg_max(TimeGenerated, *) by Id_s = tolower(Id_s);let _perf = Heartbeat  ; _perf| join kind=inner _resources on $left._ResourceId == $right.Id_s | extend d=parse_json(Tags_s) | extend CMDB_Id=d['te-cmdb-ci-id'] | summarize LastCall = max(TimeGenerated) by Computer, tostring(CMDB_Id), SubscriptionId = _SubscriptionId | where LastCall < ago(20m)";"ResultCount";"GreaterThan";"0";"5";"60";;;;;"/subscriptions/3a60e7b7-ac49-45d8-8a8f-ba61cdc5dc1f/resourceGroups/rg-teshared-custz-test/providers/microsoft.insights/actionGroups/tm-warning-actiongroup"
"Azure VM - CPU Usage - Critical";"0";"Azure VM - CPU Usage - Critical";"let _resources = TagData_CL| where (Tags_s contains '""te-managed-service"": ""workload""' or Tags_s contains '""te-managed-service"": ""true""') and Tags_s !contains '""monitoring-cpu""' | summarize arg_max(TimeGenerated, *) by Id_s = tolower(Id_s);let _perf = Perf| where ObjectName == 'Processor' and CounterName == '% Processor Time'; _perf| join kind=inner _resources on $left._ResourceId == $right.Id_s | extend d=parse_json(Tags_s) | extend CMDB_Id=d['te-cmdb-ci-id'] | summarize AggregatedValue = avg(CounterValue) by bin(TimeGenerated, 5m), Computer, tostring(CMDB_Id), _SubscriptionId";"ResultCount";"GreaterThan";"95";"5";"15";"GreaterThan";"2";"Consecutive";"Computer";"/subscriptions/3a60e7b7-ac49-45d8-8a8f-ba61cdc5dc1f/resourceGroups/rg-teshared-custz-test/providers/microsoft.insights/actionGroups/tm-critical-actiongroup"
"Azure VM - CPU Usage - Warning";"1";"Azure VM - CPU Usage - Warning";"let _resources = TagData_CL| where (Tags_s contains '""te-managed-service"": ""workload""' or Tags_s contains '""te-managed-service"": ""true""') and Tags_s !contains '""monitoring-cpu""'| summarize arg_max(TimeGenerated, *) by Id_s = tolower(Id_s);let _perf = Perf| where ObjectName == 'Processor' and CounterName == '% Processor Time'; _perf| join kind=inner _resources on $left._ResourceId == $right.Id_s | extend d=parse_json(Tags_s) | extend CMDB_Id=d['te-cmdb-ci-id'] | summarize AggregatedValue = avg(CounterValue) by bin(TimeGenerated, 5m), Computer, tostring(CMDB_Id), _SubscriptionId";"ResultCount";"GreaterThan";"90";"5";"15";"GreaterThan";"2";"Consecutive";"Computer";"/subscriptions/3a60e7b7-ac49-45d8-8a8f-ba61cdc5dc1f/resourceGroups/rg-teshared-custz-test/providers/microsoft.insights/actionGroups/tm-warning-actiongroup"
"Azure VM - CPU Usage High - Critical";"0";"Azure VM - CPU Usage High - Critical";"let _resources = TagData_CL| where (Tags_s contains '""te-managed-service"": ""workload""' or Tags_s contains '""te-managed-service"": ""true""') and Tags_s contains '""monitoring-cpu"": ""high""' | summarize arg_max(TimeGenerated, *) by Id_s = tolower(Id_s);let _perf = Perf| where ObjectName == 'Processor' and CounterName == '% Processor Time'; _perf| join kind=inner _resources on $left._ResourceId == $right.Id_s | extend d=parse_json(Tags_s) | extend CMDB_Id=d['te-cmdb-ci-id'] | summarize AggregatedValue = avg(CounterValue) by bin(TimeGenerated, 5m), Computer, tostring(CMDB_Id), _SubscriptionId";"ResultCount";"GreaterThan";"98";"5";"15";"GreaterThan";"2";"Consecutive";"Computer";"/subscriptions/3a60e7b7-ac49-45d8-8a8f-ba61cdc5dc1f/resourceGroups/rg-teshared-custz-test/providers/microsoft.insights/actionGroups/tm-critical-actiongroup"
"Azure VM - CPU Usage High - Warning";"1";"Azure VM - CPU Usage High - Warning";"let _resources = TagData_CL| where (Tags_s contains '""te-managed-service"": ""workload""' or Tags_s contains '""te-managed-service"": ""true""') and Tags_s contains '""monitoring-cpu"": ""high""' | summarize arg_max(TimeGenerated, *) by Id_s = tolower(Id_s);let _perf = Perf| where ObjectName == 'Processor' and CounterName == '% Processor Time'; _perf| join kind=inner _resources on $left._ResourceId == $right.Id_s | extend d=parse_json(Tags_s) | extend CMDB_Id=d['te-cmdb-ci-id'] | summarize AggregatedValue = avg(CounterValue) by bin(TimeGenerated, 5m), Computer, tostring(CMDB_Id), _SubscriptionId";"ResultCount";"GreaterThan";"95";"5";"15";"GreaterThan";"2";"Consecutive";"Computer";"/subscriptions/3a60e7b7-ac49-45d8-8a8f-ba61cdc5dc1f/resourceGroups/rg-teshared-custz-test/providers/microsoft.insights/actionGroups/tm-warning-actiongroup"
"Azure VM - CPU Usage Slow - Critical";"0";"Azure VM - CPU Usage Slow - Critical";"let _resources = TagData_CL| where (Tags_s contains '""te-managed-service"": ""workload""' or Tags_s contains '""te-managed-service"": ""true""') and Tags_s contains '""monitoring-cpu"": ""slow""' | summarize arg_max(TimeGenerated, *) by Id_s = tolower(Id_s);let _perf = Perf| where ObjectName == 'Processor' and CounterName == '% Processor Time'; _perf| join kind=inner _resources on $left._ResourceId == $right.Id_s | extend d=parse_json(Tags_s) | extend CMDB_Id=d['te-cmdb-ci-id'] | summarize AggregatedValue = avg(CounterValue) by bin(TimeGenerated, 5m), Computer, tostring(CMDB_Id), _SubscriptionId";"ResultCount";"GreaterThan";"90";"5";"15";"GreaterThan";"6";"Consecutive";"Computer";"/subscriptions/3a60e7b7-ac49-45d8-8a8f-ba61cdc5dc1f/resourceGroups/rg-teshared-custz-test/providers/microsoft.insights/actionGroups/tm-critical-actiongroup"
"Azure VM - CPU Usage Slow - Warning";"1";"Azure VM - CPU Usage Slow - Warning";"let _resources = TagData_CL| where (Tags_s contains '""te-managed-service"": ""workload""' or Tags_s contains '""te-managed-service"": ""true""') and Tags_s contains '""monitoring-cpu"": ""slow""'| summarize arg_max(TimeGenerated, *) by Id_s = tolower(Id_s);let _perf = Perf| where ObjectName == 'Processor' and CounterName == '% Processor Time'; _perf| join kind=inner _resources on $left._ResourceId == $right.Id_s | extend d=parse_json(Tags_s) | extend CMDB_Id=d['te-cmdb-ci-id'] | summarize AggregatedValue = avg(CounterValue) by bin(TimeGenerated, 5m), Computer, tostring(CMDB_Id), _SubscriptionId";"ResultCount";"GreaterThan";"80";"5";"15";"GreaterThan";"6";"Consecutive";"Computer";"/subscriptions/3a60e7b7-ac49-45d8-8a8f-ba61cdc5dc1f/resourceGroups/rg-teshared-custz-test/providers/microsoft.insights/actionGroups/tm-warning-actiongroup"
"Azure VM - Linux Disk High Used Space - Critical";"0";"Azure VM - Linux Disk High Used Space - Critical";"let _resources = TagData_CL| where (Tags_s contains '""te-managed-service"": ""workload""' or Tags_s contains '""te-managed-service"": ""true""') and Tags_s contains '""monitoring-ldisk"": ""high""'| summarize arg_max(TimeGenerated, *) by Id_s = tolower(Id_s);let _perf = Perf| where ObjectName == 'Logical Disk' and CounterName == '% Used Space'  ; _perf| join kind=inner _resources on $left._ResourceId == $right.Id_s | extend d=parse_json(Tags_s) | extend CMDB_Id=d['te-cmdb-ci-id'] | summarize AggregatedValue = avg(CounterValue) by bin(TimeGenerated, 30m), Computer, InstanceName, tostring(CMDB_Id), SubscriptionId = _SubscriptionId";"ResultCount";"GreaterThan";"95";"30";"30";"GreaterThan";"0";"Total";"Computer";"/subscriptions/3a60e7b7-ac49-45d8-8a8f-ba61cdc5dc1f/resourceGroups/rg-teshared-custz-test/providers/microsoft.insights/actionGroups/tm-critical-actiongroup"
"Azure VM - Linux Disk High Used Space - Warning";"1";"Azure VM - Linux Disk High Used Space - Warning";"let _resources = TagData_CL| where (Tags_s contains '""te-managed-service"": ""workload""' or Tags_s contains '""te-managed-service"": ""true""') and Tags_s contains '""monitoring-ldisk"": ""high""' | summarize arg_max(TimeGenerated, *) by Id_s = tolower(Id_s);let _perf = Perf| where ObjectName == 'Logical Disk' and CounterName == '% Used Space'  ; _perf| join kind=inner _resources on $left._ResourceId == $right.Id_s | extend d=parse_json(Tags_s) | extend CMDB_Id=d['te-cmdb-ci-id'] | summarize AggregatedValue = avg(CounterValue) by bin(TimeGenerated, 30m), Computer, InstanceName, tostring(CMDB_Id), SubscriptionId = _SubscriptionId";"ResultCount";"GreaterThan";"90";"30";"30";"GreaterThan";"0";"Total";"Computer";"/subscriptions/3a60e7b7-ac49-45d8-8a8f-ba61cdc5dc1f/resourceGroups/rg-teshared-custz-test/providers/microsoft.insights/actionGroups/tm-warning-actiongroup"
"Azure VM - Linux Disk Highest Used Space - Critical";"0";"Azure VM - Linux Disk Highest Used Space - Critical";"let _resources = TagData_CL| where (Tags_s contains '""te-managed-service"": ""workload""' or Tags_s contains '""te-managed-service"": ""true""') and Tags_s contains '""monitoring-ldisk"": ""highest""'| summarize arg_max(TimeGenerated, *) by Id_s = tolower(Id_s);let _perf = Perf| where ObjectName == 'Logical Disk' and CounterName == '% Used Space'  ; _perf| join kind=inner _resources on $left._ResourceId == $right.Id_s | extend d=parse_json(Tags_s) | extend CMDB_Id=d['te-cmdb-ci-id'] | summarize AggregatedValue = avg(CounterValue) by bin(TimeGenerated, 30m), Computer, InstanceName, tostring(CMDB_Id), SubscriptionId = _SubscriptionId";"ResultCount";"GreaterThan";"97";"30";"30";"GreaterThan";"0";"Total";"Computer";"/subscriptions/3a60e7b7-ac49-45d8-8a8f-ba61cdc5dc1f/resourceGroups/rg-teshared-custz-test/providers/microsoft.insights/actionGroups/tm-critical-actiongroup"
"Azure VM - Linux Disk Highest Used Space - Warning";"1";"Azure VM - Linux Disk Highest Used Space - Warning";"let _resources = TagData_CL| where (Tags_s contains '""te-managed-service"": ""workload""' or Tags_s contains '""te-managed-service"": ""true""') and Tags_s contains '""monitoring-ldisk"": ""highest""' | summarize arg_max(TimeGenerated, *) by Id_s = tolower(Id_s);let _perf = Perf| where ObjectName == 'Logical Disk' and CounterName == '% Used Space'  ; _perf| join kind=inner _resources on $left._ResourceId == $right.Id_s | extend d=parse_json(Tags_s) | extend CMDB_Id=d['te-cmdb-ci-id'] | summarize AggregatedValue = avg(CounterValue) by bin(TimeGenerated, 30m), Computer, InstanceName, tostring(CMDB_Id), SubscriptionId = _SubscriptionId";"ResultCount";"GreaterThan";"94";"30";"30";"GreaterThan";"0";"Total";"Computer";"/subscriptions/3a60e7b7-ac49-45d8-8a8f-ba61cdc5dc1f/resourceGroups/rg-teshared-custz-test/providers/microsoft.insights/actionGroups/tm-warning-actiongroup"
"Azure VM - Linux Disk Used Space - Critical";"0";"Azure VM - Linux Disk Used Space - Critical";"let _resources = TagData_CL| where (Tags_s contains '""te-managed-service"": ""workload""' or Tags_s contains '""te-managed-service"": ""true""') and Tags_s !contains '""monitoring-ldisk""'| summarize arg_max(TimeGenerated, *) by Id_s = tolower(Id_s);let _perf = Perf| where ObjectName == 'Logical Disk' and CounterName == '% Used Space'  ; _perf| join kind=inner _resources on $left._ResourceId == $right.Id_s | extend d=parse_json(Tags_s) | extend CMDB_Id=d['te-cmdb-ci-id'] | summarize AggregatedValue = avg(CounterValue) by bin(TimeGenerated, 30m), Computer, InstanceName, tostring(CMDB_Id), SubscriptionId = _SubscriptionId";"ResultCount";"GreaterThan";"90";"30";"30";"GreaterThan";"0";"Total";"Computer";"/subscriptions/3a60e7b7-ac49-45d8-8a8f-ba61cdc5dc1f/resourceGroups/rg-teshared-custz-test/providers/microsoft.insights/actionGroups/tm-critical-actiongroup"
"Azure VM - Linux Disk Used Space - Warning";"1";"Azure VM - Linux Disk Used Space - Warning";"let _resources = TagData_CL| where (Tags_s contains '""te-managed-service"": ""workload""' or Tags_s contains '""te-managed-service"": ""true""') and Tags_s !contains '""monitoring-ldisk""' | summarize arg_max(TimeGenerated, *) by Id_s = tolower(Id_s);let _perf = Perf| where ObjectName == 'Logical Disk' and CounterName == '% Used Space'  ; _perf| join kind=inner _resources on $left._ResourceId == $right.Id_s | extend d=parse_json(Tags_s) | extend CMDB_Id=d['te-cmdb-ci-id'] | summarize AggregatedValue = avg(CounterValue) by bin(TimeGenerated, 30m), Computer, InstanceName, tostring(CMDB_Id), SubscriptionId = _SubscriptionId";"ResultCount";"GreaterThan";"80";"30";"30";"GreaterThan";"0";"Total";"Computer";"/subscriptions/3a60e7b7-ac49-45d8-8a8f-ba61cdc5dc1f/resourceGroups/rg-teshared-custz-test/providers/microsoft.insights/actionGroups/tm-warning-actiongroup"
"Azure VM - Memory Usage - Critical";"0";"Azure VM - Memory Usage - Critical";"let _resources = TagData_CL| where (Tags_s contains '""te-managed-service"": ""workload""' or Tags_s contains '""te-managed-service"": ""true""') and Tags_s !contains '""monitoring-mem""'| summarize arg_max(TimeGenerated, *) by Id_s = tolower(Id_s); let _perf = InsightsMetrics| where Namespace == 'Memory' and Name == 'AvailableMB' | extend tags = todynamic(Tags) | project TimeGenerated, _ResourceId, Computer, P = round(100 - ((Val / parse_json(tags['vm.azm.ms/memorySizeMB'])) * 100)), _SubscriptionId ; _perf| join kind=inner _resources on $left._ResourceId == $right.Id_s  | extend d=parse_json(Tags_s) | extend CMDB_Id=d['te-cmdb-ci-id'] | summarize AggregatedValue = avg(P) by bin(TimeGenerated, 5m), Computer, tostring(CMDB_Id),  SubscriptionId = _SubscriptionId";"ResultCount";"GreaterThan";"95";"5";"15";"GreaterThan";"1";"Consecutive";"Computer";"/subscriptions/3a60e7b7-ac49-45d8-8a8f-ba61cdc5dc1f/resourceGroups/rg-teshared-custz-test/providers/microsoft.insights/actionGroups/tm-critical-actiongroup"
"Azure VM - Memory Usage - Warning";"1";"Azure VM - Memory Usage - Warning";"let _resources = TagData_CL| where (Tags_s contains '""te-managed-service"": ""workload""' or Tags_s contains '""te-managed-service"": ""true""') and Tags_s !contains '""monitoring-mem""'| summarize arg_max(TimeGenerated, *) by Id_s = tolower(Id_s); let _perf = InsightsMetrics| where Namespace == 'Memory' and Name == 'AvailableMB' | extend tags = todynamic(Tags) | project TimeGenerated, _ResourceId, Computer, P = round(100 - ((Val / parse_json(tags['vm.azm.ms/memorySizeMB'])) * 100)), _SubscriptionId  ; _perf| join kind=inner _resources on $left._ResourceId == $right.Id_s  | extend d=parse_json(Tags_s) | extend CMDB_Id=d['te-cmdb-ci-id'] | summarize AggregatedValue = avg(P) by bin(TimeGenerated, 5m), Computer, tostring(CMDB_Id),  SubscriptionId = _SubscriptionId";"ResultCount";"GreaterThan";"87";"5";"15";"GreaterThan";"1";"Consecutive";"Computer";"/subscriptions/3a60e7b7-ac49-45d8-8a8f-ba61cdc5dc1f/resourceGroups/rg-teshared-custz-test/providers/microsoft.insights/actionGroups/tm-warning-actiongroup"
"Azure VM - Memory Usage High - Critical";"0";"Azure VM - Memory Usage High - Critical";"let _resources = TagData_CL| where (Tags_s contains '""te-managed-service"": ""workload""' or Tags_s contains '""te-managed-service"": ""true""') and Tags_s contains '""monitoring-mem"": ""high""'| summarize arg_max(TimeGenerated, *) by Id_s = tolower(Id_s); let _perf = InsightsMetrics| where Namespace == 'Memory' and Name == 'AvailableMB' | extend tags = todynamic(Tags) | project TimeGenerated, _ResourceId, Computer, P = round(100 - ((Val / parse_json(tags['vm.azm.ms/memorySizeMB'])) * 100)), _SubscriptionId ; _perf| join kind=inner _resources on $left._ResourceId == $right.Id_s  | extend d=parse_json(Tags_s) | extend CMDB_Id=d['te-cmdb-ci-id'] | summarize AggregatedValue = avg(P) by bin(TimeGenerated, 5m), Computer, tostring(CMDB_Id),  SubscriptionId = _SubscriptionId";"ResultCount";"GreaterThan";"98";"5";"15";"GreaterThan";"1";"Consecutive";"Computer";"/subscriptions/3a60e7b7-ac49-45d8-8a8f-ba61cdc5dc1f/resourceGroups/rg-teshared-custz-test/providers/microsoft.insights/actionGroups/tm-critical-actiongroup"
"Azure VM - Memory Usage High - Warning";"1";"Azure VM - Memory Usage High - Warning";"let _resources = TagData_CL| where (Tags_s contains '""te-managed-service"": ""workload""' or Tags_s contains '""te-managed-service"": ""true""') and Tags_s contains '""monitoring-mem"": ""high""'| summarize arg_max(TimeGenerated, *) by Id_s = tolower(Id_s); let _perf = InsightsMetrics| where Namespace == 'Memory' and Name == 'AvailableMB' | extend tags = todynamic(Tags) | project TimeGenerated, _ResourceId, Computer, P = round(100 - ((Val / parse_json(tags['vm.azm.ms/memorySizeMB'])) * 100)), _SubscriptionId  ; _perf| join kind=inner _resources on $left._ResourceId == $right.Id_s  | extend d=parse_json(Tags_s) | extend CMDB_Id=d['te-cmdb-ci-id'] | summarize AggregatedValue = avg(P) by bin(TimeGenerated, 5m), Computer, tostring(CMDB_Id),  SubscriptionId = _SubscriptionId";"ResultCount";"GreaterThan";"96";"5";"15";"GreaterThan";"1";"Consecutive";"Computer";"/subscriptions/3a60e7b7-ac49-45d8-8a8f-ba61cdc5dc1f/resourceGroups/rg-teshared-custz-test/providers/microsoft.insights/actionGroups/tm-warning-actiongroup"
"Azure VM - Memory Usage Slow - Critical";"0";"Azure VM - Memory Usage Slow - Critical";"let _resources = TagData_CL| where (Tags_s contains '""te-managed-service"": ""workload""' or Tags_s contains '""te-managed-service"": ""true""') and Tags_s contains '""monitoring-mem"": ""slow""'| summarize arg_max(TimeGenerated, *) by Id_s = tolower(Id_s); let _perf = InsightsMetrics| where Namespace == 'Memory' and Name == 'AvailableMB' | extend tags = todynamic(Tags) | project TimeGenerated, _ResourceId, Computer, P = round(100 - ((Val / parse_json(tags['vm.azm.ms/memorySizeMB'])) * 100)), _SubscriptionId ; _perf| join kind=inner _resources on $left._ResourceId == $right.Id_s  | extend d=parse_json(Tags_s) | extend CMDB_Id=d['te-cmdb-ci-id'] | summarize AggregatedValue = avg(P) by bin(TimeGenerated, 5m), Computer, tostring(CMDB_Id),  SubscriptionId = _SubscriptionId";"ResultCount";"GreaterThan";"95";"5";"15";"GreaterThan";"6";"Consecutive";"Computer";"/subscriptions/3a60e7b7-ac49-45d8-8a8f-ba61cdc5dc1f/resourceGroups/rg-teshared-custz-test/providers/microsoft.insights/actionGroups/tm-critical-actiongroup"
"Azure VM - Memory Usage Slow - Warning";"1";"Azure VM - Memory Usage Slow - Warning";"let _resources = TagData_CL| where (Tags_s contains '""te-managed-service"": ""workload""' or Tags_s contains '""te-managed-service"": ""true""') and Tags_s contains '""monitoring-mem"": ""slow""'| summarize arg_max(TimeGenerated, *) by Id_s = tolower(Id_s); let _perf = InsightsMetrics| where Namespace == 'Memory' and Name == 'AvailableMB' | extend tags = todynamic(Tags) | project TimeGenerated, _ResourceId, Computer, P = round(100 - ((Val / parse_json(tags['vm.azm.ms/memorySizeMB'])) * 100)), _SubscriptionId  ; _perf| join kind=inner _resources on $left._ResourceId == $right.Id_s  | extend d=parse_json(Tags_s) | extend CMDB_Id=d['te-cmdb-ci-id'] | summarize AggregatedValue = avg(P) by bin(TimeGenerated, 5m), Computer, tostring(CMDB_Id),  SubscriptionId = _SubscriptionId";"ResultCount";"GreaterThan";"87";"5";"15";"GreaterThan";"6";"Consecutive";"Computer";"/subscriptions/3a60e7b7-ac49-45d8-8a8f-ba61cdc5dc1f/resourceGroups/rg-teshared-custz-test/providers/microsoft.insights/actionGroups/tm-warning-actiongroup"
"Azure VM - Win Data Disk Free Space - Critical";"0";"Azure VM - Win Data Disk Free Space - Critical";"let _resources = TagData_CL| where (Tags_s contains '""te-managed-service"": ""workload""' or Tags_s contains '""te-managed-service"": ""true""') and Tags_s !contains '""monitoring-wdatadisk""'| summarize arg_max(TimeGenerated, *) by Id_s = tolower(Id_s);let _perf = Perf| where ObjectName == 'LogicalDisk' and CounterName == '% Free Space' and InstanceName != 'C:' and InstanceName != '_Total' and InstanceName notcontains 'Harddisk'  ; _perf| join kind=inner _resources on $left._ResourceId == $right.Id_s | extend d=parse_json(Tags_s) | extend CMDB_Id=d['te-cmdb-ci-id'] | summarize AggregatedValue = avg(CounterValue) by bin(TimeGenerated, 30m), Computer, InstanceName, tostring(CMDB_Id), SubscriptionId = _SubscriptionId";"ResultCount";"LessThan";"10";"30";"30";"GreaterThan";"0";"Total";"Computer";"/subscriptions/3a60e7b7-ac49-45d8-8a8f-ba61cdc5dc1f/resourceGroups/rg-teshared-custz-test/providers/microsoft.insights/actionGroups/tm-critical-actiongroup"
"Azure VM - Win Data Disk Free Space - Warning";"1";"Azure VM - Win Data Disk Free Space - Warning";"let _resources = TagData_CL| where (Tags_s contains '""te-managed-service"": ""workload""' or Tags_s contains '""te-managed-service"": ""true""') and Tags_s !contains '""monitoring-wdatadisk""' | summarize arg_max(TimeGenerated, *) by Id_s = tolower(Id_s);let _perf = Perf| where ObjectName == 'LogicalDisk' and CounterName == '% Free Space' and InstanceName != 'C:' and InstanceName != '_Total' and InstanceName notcontains 'Harddisk'  ; _perf| join kind=inner _resources on $left._ResourceId == $right.Id_s | extend d=parse_json(Tags_s) | extend CMDB_Id=d['te-cmdb-ci-id'] | summarize AggregatedValue = avg(CounterValue) by bin(TimeGenerated, 30m), Computer, InstanceName, tostring(CMDB_Id), SubscriptionId = _SubscriptionId";"ResultCount";"LessThan";"20";"30";"30";"GreaterThan";"0";"Total";"Computer";"/subscriptions/3a60e7b7-ac49-45d8-8a8f-ba61cdc5dc1f/resourceGroups/rg-teshared-custz-test/providers/microsoft.insights/actionGroups/tm-warning-actiongroup"
"Azure VM - Win Data High Disk Free Space - Critical";"0";"Azure VM - Win Data High Disk Free Space - Critical";"let _resources = TagData_CL| where (Tags_s contains '""te-managed-service"": ""workload""' or Tags_s contains '""te-managed-service"": ""true""') and Tags_s contains '""monitoring-wdatadisk"": ""high""'| summarize arg_max(TimeGenerated, *) by Id_s = tolower(Id_s);let _perf = Perf| where ObjectName == 'LogicalDisk' and CounterName == '% Free Space' and InstanceName != 'C:' and InstanceName != '_Total' and InstanceName notcontains 'Harddisk'  ; _perf| join kind=inner _resources on $left._ResourceId == $right.Id_s | extend d=parse_json(Tags_s) | extend CMDB_Id=d['te-cmdb-ci-id'] | summarize AggregatedValue = avg(CounterValue) by bin(TimeGenerated, 30m), Computer, InstanceName, tostring(CMDB_Id), SubscriptionId = _SubscriptionId";"ResultCount";"LessThan";"5";"30";"30";"GreaterThan";"0";"Total";"Computer";"/subscriptions/3a60e7b7-ac49-45d8-8a8f-ba61cdc5dc1f/resourceGroups/rg-teshared-custz-test/providers/microsoft.insights/actionGroups/tm-critical-actiongroup"
"Azure VM - Win Data High Disk Free Space - Warning";"1";"Azure VM - Win Data High Disk Free Space - Warning";"let _resources = TagData_CL| where (Tags_s contains '""te-managed-service"": ""workload""' or Tags_s contains '""te-managed-service"": ""true""') and Tags_s contains '""monitoring-wdatadisk"": ""high""' | summarize arg_max(TimeGenerated, *) by Id_s = tolower(Id_s);let _perf = Perf| where ObjectName == 'LogicalDisk' and CounterName == '% Free Space' and InstanceName != 'C:' and InstanceName != '_Total' and InstanceName notcontains 'Harddisk'  ; _perf| join kind=inner _resources on $left._ResourceId == $right.Id_s | extend d=parse_json(Tags_s) | extend CMDB_Id=d['te-cmdb-ci-id'] | summarize AggregatedValue = avg(CounterValue) by bin(TimeGenerated, 30m), Computer, InstanceName, tostring(CMDB_Id), SubscriptionId = _SubscriptionId";"ResultCount";"LessThan";"10";"30";"30";"GreaterThan";"0";"Total";"Computer";"/subscriptions/3a60e7b7-ac49-45d8-8a8f-ba61cdc5dc1f/resourceGroups/rg-teshared-custz-test/providers/microsoft.insights/actionGroups/tm-warning-actiongroup"
"Azure VM - Win Data Highest Disk Free Space - Critical";"0";"Azure VM - Win Data Highest Disk Free Space - Critical";"let _resources = TagData_CL| where (Tags_s contains '""te-managed-service"": ""workload""' or Tags_s contains '""te-managed-service"": ""true""') and Tags_s contains '""monitoring-wdatadisk"": ""highest""'| summarize arg_max(TimeGenerated, *) by Id_s = tolower(Id_s);let _perf = Perf| where ObjectName == 'LogicalDisk' and CounterName == '% Free Space' and InstanceName != 'C:' and InstanceName != '_Total' and InstanceName notcontains 'Harddisk'  ; _perf| join kind=inner _resources on $left._ResourceId == $right.Id_s | extend d=parse_json(Tags_s) | extend CMDB_Id=d['te-cmdb-ci-id'] | summarize AggregatedValue = avg(CounterValue) by bin(TimeGenerated, 30m), Computer, InstanceName, tostring(CMDB_Id), SubscriptionId = _SubscriptionId";"ResultCount";"LessThan";"4";"30";"30";"GreaterThan";"0";"Total";"Computer";"/subscriptions/3a60e7b7-ac49-45d8-8a8f-ba61cdc5dc1f/resourceGroups/rg-teshared-custz-test/providers/microsoft.insights/actionGroups/tm-critical-actiongroup"
"Azure VM - Win Data Highest Disk Free Space - Warning";"1";"Azure VM - Win Data Highest Disk Free Space - Warning";"let _resources = TagData_CL| where (Tags_s contains '""te-managed-service"": ""workload""' or Tags_s contains '""te-managed-service"": ""true""') and Tags_s contains '""monitoring-wdatadisk"": ""highest""' | summarize arg_max(TimeGenerated, *) by Id_s = tolower(Id_s);let _perf = Perf| where ObjectName == 'LogicalDisk' and CounterName == '% Free Space' and InstanceName != 'C:' and InstanceName != '_Total' and InstanceName notcontains 'Harddisk'  ; _perf| join kind=inner _resources on $left._ResourceId == $right.Id_s | extend d=parse_json(Tags_s) | extend CMDB_Id=d['te-cmdb-ci-id'] | summarize AggregatedValue = avg(CounterValue) by bin(TimeGenerated, 30m), Computer, InstanceName, tostring(CMDB_Id), SubscriptionId = _SubscriptionId";"ResultCount";"LessThan";"7";"30";"30";"GreaterThan";"0";"Total";"Computer";"/subscriptions/3a60e7b7-ac49-45d8-8a8f-ba61cdc5dc1f/resourceGroups/rg-teshared-custz-test/providers/microsoft.insights/actionGroups/tm-warning-actiongroup"
"Azure VM - Win OS Disk Free Space - Critical";"0";"Azure VM - Win OS Disk Free Space - Critical";"let _resources = TagData_CL| where (Tags_s contains '""te-managed-service"": ""workload""' or Tags_s contains '""te-managed-service"": ""true""') and Tags_s !contains '""monitoring-wosdisk""'| summarize arg_max(TimeGenerated, *) by Id_s = tolower(Id_s);let _perf = Perf| where ObjectName == 'LogicalDisk' and CounterName == '% Free Space' and InstanceName == 'C:'  ; _perf| join kind=inner _resources on $left._ResourceId == $right.Id_s | extend d=parse_json(Tags_s) | extend CMDB_Id=d['te-cmdb-ci-id'] | summarize AggregatedValue = avg(CounterValue) by bin(TimeGenerated, 30m), Computer, InstanceName, tostring(CMDB_Id),  SubscriptionId = _SubscriptionId";"ResultCount";"LessThan";"10";"30";"30";"GreaterThan";"0";"Total";"Computer";"/subscriptions/3a60e7b7-ac49-45d8-8a8f-ba61cdc5dc1f/resourceGroups/rg-teshared-custz-test/providers/microsoft.insights/actionGroups/tm-critical-actiongroup"
"Azure VM - Win OS Disk Free Space - Warning";"1";"Azure VM - Win OS Disk Free Space - Warning";"let _resources = TagData_CL| where (Tags_s contains '""te-managed-service"": ""workload""' or Tags_s contains '""te-managed-service"": ""true""') and Tags_s !contains '""monitoring-wosdisk""'| summarize arg_max(TimeGenerated, *) by Id_s = tolower(Id_s);let _perf = Perf| where ObjectName == 'LogicalDisk' and CounterName == '% Free Space' and InstanceName == 'C:'  ; _perf| join kind=inner _resources on $left._ResourceId == $right.Id_s | extend d=parse_json(Tags_s) | extend CMDB_Id=d['te-cmdb-ci-id'] | summarize AggregatedValue = avg(CounterValue) by bin(TimeGenerated, 30m), Computer, InstanceName, tostring(CMDB_Id),  SubscriptionId = _SubscriptionId";"ResultCount";"LessThan";"20";"30";"30";"GreaterThan";"0";"Total";"Computer";"/subscriptions/3a60e7b7-ac49-45d8-8a8f-ba61cdc5dc1f/resourceGroups/rg-teshared-custz-test/providers/microsoft.insights/actionGroups/tm-warning-actiongroup"
"Azure VM - Win OS Disk High Free Space - Critical";"0";"Azure VM - Win OS Disk High Free Space - Critical";"let _resources = TagData_CL| where (Tags_s contains '""te-managed-service"": ""workload""' or Tags_s contains '""te-managed-service"": ""true""') and Tags_s contains '""monitoring-wosdisk"": ""high""'| summarize arg_max(TimeGenerated, *) by Id_s = tolower(Id_s);let _perf = Perf| where ObjectName == 'LogicalDisk' and CounterName == '% Free Space' and InstanceName == 'C:'  ; _perf| join kind=inner _resources on $left._ResourceId == $right.Id_s | extend d=parse_json(Tags_s) | extend CMDB_Id=d['te-cmdb-ci-id'] | summarize AggregatedValue = avg(CounterValue) by bin(TimeGenerated, 30m), Computer, InstanceName, tostring(CMDB_Id),  SubscriptionId = _SubscriptionId";"ResultCount";"LessThan";"5";"30";"30";"GreaterThan";"0";"Total";"Computer";"/subscriptions/3a60e7b7-ac49-45d8-8a8f-ba61cdc5dc1f/resourceGroups/rg-teshared-custz-test/providers/microsoft.insights/actionGroups/tm-critical-actiongroup"
"Azure VM - Win OS Disk High Free Space - Warning";"1";"Azure VM - Win OS Disk High Free Space - Warning";"let _resources = TagData_CL| where (Tags_s contains '""te-managed-service"": ""workload""' or Tags_s contains '""te-managed-service"": ""true""') and Tags_s contains '""monitoring-wosdisk"": ""high""'| summarize arg_max(TimeGenerated, *) by Id_s = tolower(Id_s);let _perf = Perf| where ObjectName == 'LogicalDisk' and CounterName == '% Free Space' and InstanceName == 'C:'  ; _perf| join kind=inner _resources on $left._ResourceId == $right.Id_s | extend d=parse_json(Tags_s) | extend CMDB_Id=d['te-cmdb-ci-id'] | summarize AggregatedValue = avg(CounterValue) by bin(TimeGenerated, 30m), Computer, InstanceName, tostring(CMDB_Id),  SubscriptionId = _SubscriptionId";"ResultCount";"LessThan";"10";"30";"30";"GreaterThan";"0";"Total";"Computer";"/subscriptions/3a60e7b7-ac49-45d8-8a8f-ba61cdc5dc1f/resourceGroups/rg-teshared-custz-test/providers/microsoft.insights/actionGroups/tm-warning-actiongroup"
"Azure VM - Win OS Disk Highest Free Space - Critical";"0";"Azure VM - Win OS Disk Highest Free Space - Critical";"let _resources = TagData_CL| where (Tags_s contains '""te-managed-service"": ""workload""' or Tags_s contains '""te-managed-service"": ""true""') and Tags_s contains '""monitoring-wosdisk"": ""highest""'| summarize arg_max(TimeGenerated, *) by Id_s = tolower(Id_s);let _perf = Perf| where ObjectName == 'LogicalDisk' and CounterName == '% Free Space' and InstanceName == 'C:'  ; _perf| join kind=inner _resources on $left._ResourceId == $right.Id_s | extend d=parse_json(Tags_s) | extend CMDB_Id=d['te-cmdb-ci-id'] | summarize AggregatedValue = avg(CounterValue) by bin(TimeGenerated, 30m), Computer, InstanceName, tostring(CMDB_Id),  SubscriptionId = _SubscriptionId";"ResultCount";"LessThan";"7";"30";"30";"GreaterThan";"0";"Total";"Computer";"/subscriptions/3a60e7b7-ac49-45d8-8a8f-ba61cdc5dc1f/resourceGroups/rg-teshared-custz-test/providers/microsoft.insights/actionGroups/tm-critical-actiongroup"
"Azure VM - Win OS Disk Highest Free Space - Warning";"1";"Azure VM - Win OS Disk Highest Free Space - Warning";"let _resources = TagData_CL| where (Tags_s contains '""te-managed-service"": ""workload""' or Tags_s contains '""te-managed-service"": ""true""') and Tags_s contains '""monitoring-wosdisk"": ""highest""'| summarize arg_max(TimeGenerated, *) by Id_s = tolower(Id_s);let _perf = Perf| where ObjectName == 'LogicalDisk' and CounterName == '% Free Space' and InstanceName == 'C:'  ; _perf| join kind=inner _resources on $left._ResourceId == $right.Id_s | extend d=parse_json(Tags_s) | extend CMDB_Id=d['te-cmdb-ci-id'] | summarize AggregatedValue = avg(CounterValue) by bin(TimeGenerated, 30m), Computer, InstanceName, tostring(CMDB_Id),  SubscriptionId = _SubscriptionId";"ResultCount";"LessThan";"4";"30";"30";"GreaterThan";"0";"Total";"Computer";"/subscriptions/3a60e7b7-ac49-45d8-8a8f-ba61cdc5dc1f/resourceGroups/rg-teshared-custz-test/providers/microsoft.insights/actionGroups/tm-warning-actiongroup"
"Backups - Job Status - Critical";"0";"Backups - Job Status - Critical";"let _resources = TagData_CL| where Tags_s contains '""te-managed-service"": ""workload""'| summarize arg_max(TimeGenerated, *) by Id_s = tolower(Id_s);let _perf = AddonAzureBackupJobs | where JobStatus == 'Failed' ; _perf| join kind=inner _resources on $left._ResourceId == $right.Id_s";"ResultCount";"GreaterThan";"0";"60";"60";;;;;"/subscriptions/3a60e7b7-ac49-45d8-8a8f-ba61cdc5dc1f/resourceGroups/rg-teshared-custz-test/providers/microsoft.insights/actionGroups/tm-critical-actiongroup"
"Backups - Job Status - Warning";"1";"Backups - Job Status - Warning";"let _resources = TagData_CL| where Tags_s contains '""te-managed-service"": ""workload""'| summarize arg_max(TimeGenerated, *) by Id_s = tolower(Id_s);let _perf = AddonAzureBackupJobs | where JobStatus == 'CompletedWithWarnings' ; _perf| join kind=inner _resources on $left._ResourceId == $right.Id_s";"ResultCount";"GreaterThan";"0";"60";"60";;;;;"/subscriptions/3a60e7b7-ac49-45d8-8a8f-ba61cdc5dc1f/resourceGroups/rg-teshared-custz-test/providers/microsoft.insights/actionGroups/tm-warning-actiongroup"
"Data Factory - Failed Pipeline Runs - Critical";"0";"Data Factory - Failed Pipeline Runs - Critical";"let _resources = TagData_CL | where Tags_s contains '""te-managed-service"": ""workload""' | summarize arg_max(TimeGenerated, *) by Id_s = tolower(Id_s); let _perf = ADFPipelineRun | where Status in ('Failed') ; _perf | join kind=inner _resources on $left._ResourceId == $right.Id_s";"ResultCount";"GreaterThan";"1";"5";"15";;;;;"/subscriptions/3a60e7b7-ac49-45d8-8a8f-ba61cdc5dc1f/resourceGroups/rg-teshared-custz-test/providers/microsoft.insights/actionGroups/tm-critical-actiongroup"
"Data Factory - Failed Pipeline Runs - Warning";"1";"Data Factory - Failed Pipeline Runs - Warning";"let _resources = TagData_CL | where Tags_s contains '""te-managed-service"": ""workload""' | summarize arg_max(TimeGenerated, *) by Id_s = tolower(Id_s); let _perf = ADFPipelineRun | where Status in ('Failed') ; _perf | join kind=inner _resources on $left._ResourceId == $right.Id_s";"ResultCount";"GreaterThan";"0";"5";"15";"GreaterThan";"0";"Consecutive";"Resource";"/subscriptions/3a60e7b7-ac49-45d8-8a8f-ba61cdc5dc1f/resourceGroups/rg-teshared-custz-test/providers/microsoft.insights/actionGroups/tm-warning-actiongroup"
"Express Route - ARP Availability - Critical";"0";"Express Route - ARP Availability - Critical";"let _resources = TagData_CL| where Tags_s contains '""te-managed-service"": ""workload""'| summarize arg_max(TimeGenerated, *) by Id_s = tolower(Id_s);let _perf = AzureMetrics | where MetricName == 'ArpAvailability' ; _perf| join kind=inner _resources on $left._ResourceId == $right.Id_s | summarize by Average, bin(TimeGenerated, 5m), Resource";"ResultCount";"LessThan";"80";"5";"5";"GreaterThan";"0";"Consecutive";"Resource";"/subscriptions/3a60e7b7-ac49-45d8-8a8f-ba61cdc5dc1f/resourceGroups/rg-teshared-custz-test/providers/microsoft.insights/actionGroups/tm-critical-actiongroup"
"Express Route - ARP Availability - Warning";"0";"Express Route - ARP Availability - Warning";"let _resources = TagData_CL| where Tags_s contains '""te-managed-service"": ""workload""'| summarize arg_max(TimeGenerated, *) by Id_s = tolower(Id_s);let _perf = AzureMetrics | where MetricName == 'ArpAvailability' ; _perf| join kind=inner _resources on $left._ResourceId == $right.Id_s | summarize by AggregatedValue = Average, bin(TimeGenerated, 5m), Resource";"ResultCount";"LessThan";"95";"5";"5";"GreaterThan";"0";"Consecutive";"Resource";"/subscriptions/3a60e7b7-ac49-45d8-8a8f-ba61cdc5dc1f/resourceGroups/rg-teshared-custz-test/providers/microsoft.insights/actionGroups/tm-warning-actiongroup"
"Express Route - BGP Availability - Critical";"0";"Express Route - BGP Availability - Critical";"let _resources = TagData_CL| where Tags_s contains '""te-managed-service"": ""workload""'| summarize arg_max(TimeGenerated, *) by Id_s = tolower(Id_s);let _perf = AzureMetrics | where MetricName == 'BgpAvailability' ; _perf| join kind=inner _resources on $left._ResourceId == $right.Id_s | summarize by Average, bin(TimeGenerated, 5m), Resource";"ResultCount";"LessThan";"80";"5";"5";"GreaterThan";"0";"Consecutive";"Resource";"/subscriptions/3a60e7b7-ac49-45d8-8a8f-ba61cdc5dc1f/resourceGroups/rg-teshared-custz-test/providers/microsoft.insights/actionGroups/tm-critical-actiongroup"
"Express Route - BGP Availability - Warning";"0";"Express Route - BGP Availability - Warning";"let _resources = TagData_CL| where Tags_s contains '""te-managed-service"": ""workload""'| summarize arg_max(TimeGenerated, *) by Id_s = tolower(Id_s);let _perf = AzureMetrics | where MetricName == 'BgpAvailability' ; _perf| join kind=inner _resources on $left._ResourceId == $right.Id_s | summarize by AggregatedValue = Average, bin(TimeGenerated, 5m), Resource";"ResultCount";"LessThan";"95";"5";"5";"GreaterThan";"0";"Consecutive";"Resource";"/subscriptions/3a60e7b7-ac49-45d8-8a8f-ba61cdc5dc1f/resourceGroups/rg-teshared-custz-test/providers/microsoft.insights/actionGroups/tm-warning-actiongroup"
"Load Balancer (Standard SKU) - Health Percentage - Critical";"0";"Load Balancer (Standard SKU) - Health Percentage - Critical";"let _resources = TagData_CL| where Tags_s contains '""te-managed-service"": ""workload""'| summarize arg_max(TimeGenerated, *) by Id_s = tolower(Id_s);let _perf = AzureMetrics | where MetricName == 'VipAvailability' ; _perf| join kind=inner _resources on $left._ResourceId == $right.Id_s | summarize by AggregatedValue = Average, bin(TimeGenerated, 5m), Resource";"ResultCount";"LessThan";"90";"5";"5";"GreaterThan";"0";"Consecutive";"Resource";"/subscriptions/3a60e7b7-ac49-45d8-8a8f-ba61cdc5dc1f/resourceGroups/rg-teshared-custz-test/providers/microsoft.insights/actionGroups/tm-critical-actiongroup"
"Load Balancer (Standard SKU) - Health Percentage - Warning";"1";"Load Balancer (Standard SKU) - Health Percentage - Warning";"let _resources = TagData_CL| where Tags_s contains '""te-managed-service"": ""workload""'| summarize arg_max(TimeGenerated, *) by Id_s = tolower(Id_s);let _perf = AzureMetrics | where MetricName == 'VipAvailability' ; _perf| join kind=inner _resources on $left._ResourceId == $right.Id_s | summarize by AggregatedValue = Average, bin(TimeGenerated, 5m), Resource";"ResultCount";"LessThan";"100";"5";"5";"GreaterThan";"0";"Consecutive";"Resource";"/subscriptions/3a60e7b7-ac49-45d8-8a8f-ba61cdc5dc1f/resourceGroups/rg-teshared-custz-test/providers/microsoft.insights/actionGroups/tm-warning-actiongroup"
"Logic Apps - Runs Failed - Critical";"0";"Logic Apps - Runs Failed - Critical";"let _resources = TagData_CL| where Tags_s contains '""te-managed-service"": ""workload""'| summarize arg_max(TimeGenerated, *) by Id_s = tolower(Id_s);let _perf = AzureMetrics | where ResourceProvider == 'MICROSOFT.LOGIC' and MetricName == 'RunsFailed'  ; _perf| join kind=inner _resources on $left._ResourceId == $right.Id_s | summarize AggregatedValue = sum(Total) by bin(TimeGenerated, 5m), Resource";"ResultCount";"GreaterThan";"2";"15";"30";"GreaterThan";"0";"Consecutive";"Resource";"/subscriptions/3a60e7b7-ac49-45d8-8a8f-ba61cdc5dc1f/resourceGroups/rg-teshared-custz-test/providers/microsoft.insights/actionGroups/tm-critical-actiongroup"
"Logic Apps - Runs Failed - Warning";"1";"Logic Apps - Runs Failed - Warning";"let _resources = TagData_CL| where Tags_s contains '""te-managed-service"": ""workload""'| summarize arg_max(TimeGenerated, *) by Id_s = tolower(Id_s);let _perf = AzureMetrics | where ResourceProvider == 'MICROSOFT.LOGIC' and MetricName == 'RunsFailed'  ; _perf| join kind=inner _resources on $left._ResourceId == $right.Id_s | summarize AggregatedValue = sum(Total) by bin(TimeGenerated, 5m), Resource";"ResultCount";"GreaterThan";"0";"15";"30";"GreaterThan";"0";"Consecutive";"Resource";"/subscriptions/3a60e7b7-ac49-45d8-8a8f-ba61cdc5dc1f/resourceGroups/rg-teshared-custz-test/providers/microsoft.insights/actionGroups/tm-warning-actiongroup"
"Tagging Function - Critical";"0";"Tagging Function - Critical";"TagData_CL";"ResultCount";"LessThan";"1";"5";"5";;;;;"/subscriptions/3a60e7b7-ac49-45d8-8a8f-ba61cdc5dc1f/resourceGroups/rg-teshared-custz-test/providers/microsoft.insights/actionGroups/tm-critical-actiongroup"
